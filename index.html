<title>Mt. Moon</title>
<style>
body {display: flex; justify-content: center; align-items: center; background: #1b1d26; width: 100dvw; height: 100dvh; margin: 0px}
#screen {
	width: calc(160px * 3);
	height: calc(144px * 3);
	image-rendering: pixelated;
	border: 12px solid #253238;
	border-radius: 6px;
}
</style>
<script type=module>
const maps = {
	f1: [
		[5,4,4,3,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3],
		[6,1,1,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
		[6,1,1,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
		[6,1,1,2,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,3],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,16,15,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,17,18,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,5,4,4,4,4,4,4,3,5,4,4,4,4,4,4,3,5,4,4,4,4,4,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,1,1,1,1,2,6,1,1,1,1,1,1,2,6,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,1,1,1,1,2,6,1,1,1,1,1,1,2,6,1,1,1,1,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,7,8,8,8,8,8,8,9,7,8,8,8,8,8,8,9,7,8,8,8,8,8,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,16,15,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,17,18,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,16,15,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,17,18,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,5,4,4,4,4,4,4,4,4,4,4,3,5,4,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,3,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,6,1,1,1,1,1,1,1,1,1,1,2,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,6,1,1,1,1,1,1,1,1,1,1,2,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,7,8,8,8,8,8,8,8,8,8,8,9,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,6,1,1,2,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,6,1,1,2,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,6,1,1,2,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,7,8,8,9,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,30,29,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,0,0,31,32,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,3,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,3,0,5,4,4,4,4,4,4,3,0,0,0,0,0,5,4,4,4,4,3,0,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,6,1,1,1,1,2,3,6,1,1,1,1,1,1,2,0,0,0,0,5,6,1,1,1,1,2,3,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,6,1,1,1,1,1,1,2,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,6,1,1,2,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,7,8,8,8,8,8,8,9,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,7,8,8,9,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,4,4,4,4,3,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,6,1,1,1,1,2,3,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,6,7,8,8,8,8,9,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,8,8,8,8,9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,1,1,2],
		[6,1,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,9],
		[6,1,1,2,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,6,6,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,2,2,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3],
		[6,1,1,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,6,6,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,2,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
		[6,1,1,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,6,7,8,8,8,8,9,2,33,33,33,33,6,7,8,8,8,8,9,2,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2],
		[7,8,8,9,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,7,8,8,8,8,8,8,9,33,33,33,33,7,8,8,8,8,8,8,9,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9],
	],
	b1: [
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,16,15,1,1,1,1,1,1,20,19],
		[34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,17,18,1,1,1,1,1,1,21,22],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,20,19,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,21,22,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,19,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,21,22,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,16,15,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,17,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,34,34,34,34,1,1,20,19,1,1,1,1],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,34,34,34,34,1,1,21,22,1,1,1,1],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,16,15,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,17,18,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,16,15,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
		[34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,1,1,1,1,1,1,17,18,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
	],
	b2: [
		[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[12,11,12,11,0,5,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,0,12,11,12,11,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[13,14,13,14,5,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,13,14,13,14,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[12,11,12,11,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,12,11,12,11,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[13,14,13,14,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,13,14,13,14,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[12,11,12,11,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,12,11,12,11,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[13,14,13,14,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,13,14,13,14,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[12,11,12,11,6,7,24,23,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,10,1,1,1,1,35,8,8,8,8,8,9,2,12,11,12,11,1,1,1,1,1,1,35,8,8,8,8,8,8,10,1,1,1,1,1,1,1,1,35,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[13,14,13,14,7,8,24,23,8,8,8,8,8,8,8,8,8,8,8,8,8,8,10,6,1,1,1,1,2,35,8,8,8,8,8,9,13,14,13,14,1,1,1,1,1,1,2,35,8,8,8,8,10,6,1,1,1,1,1,1,1,1,2,35,8,8,8,8,8,8,8,8,1,1,1,1,1,1,1,1],
		[12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,0,5,4,4,4,4,4,4,1,1,1,1,4,4,4,4,4,4,3,0,12,11,12,11,1,1,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],
		[13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,5,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,13,14,13,14,1,1,1,1,1,1,2,2,0,0,0,0,6,6,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],
		[12,11,12,11,1,1,1,1,1,1,20,19,1,1,1,1,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,12,11,12,11,1,1,1,1,1,1,2,2,0,0,0,0,6,7,8,8,24,23,24,23,8,8,9,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],
		[13,14,13,14,1,1,1,1,1,1,21,22,1,1,1,1,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,13,14,13,14,1,1,1,1,1,1,2,2,0,0,0,0,7,8,8,8,24,23,24,23,8,8,8,9,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1],
		[12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,12,11,12,11,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8],
		[13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,13,14,13,14,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8],
		[12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,6,7,8,8,8,8,8,8,24,23,24,23,8,10,1,1,1,1,2,2,12,11,12,11,1,1,1,1,1,1,2,2,0,0,20,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,26,25,0,0,0,0,8,8,8,8,8,8,8,8],
		[13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,7,8,8,8,8,8,8,8,24,23,24,23,10,6,1,1,1,1,2,2,13,14,13,14,1,1,1,1,1,1,2,2,0,0,21,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,27,28,0,0,0,0,8,8,8,8,8,8,8,8],
		[8,8,8,8,8,8,8,8,8,8,8,8,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,6,6,1,1,1,1,2,2,12,11,12,11,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8],
		[8,8,8,8,8,8,8,8,8,8,8,8,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,6,6,1,1,1,1,2,2,13,14,13,14,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8],
		[8,8,8,8,8,8,8,8,8,8,8,8,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,6,7,8,8,8,8,9,2,12,11,12,11,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8],
		[8,8,8,8,8,8,8,8,8,8,8,8,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,7,8,8,8,8,8,8,9,13,14,13,14,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8],
		[0,0,0,0,0,0,0,0,0,0,0,0,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,3,0,0,5,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,35,8],
		[0,0,0,0,0,0,0,0,0,0,0,0,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,5,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,35],
		[0,0,0,0,0,0,0,0,0,0,0,0,12,11,12,11,12,11,12,11,12,11,12,11,1,1,1,1,12,11,12,11,12,11,12,11,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,13,14,13,14,13,14,13,14,13,14,13,14,1,1,1,1,13,14,13,14,13,14,13,14,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,8,8,8,8,8,8,8,8,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,8,8,8,8,8,8,8,8,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,8,8,8,8,8,8,8,8,12,11,12,11,1,1,1,1,1,1,1,1,35,8,8,8,24,23,24,23,8,8,9,2,6,7,8,8,24,23,24,23,8,8,8,10,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,8,8,8,8,8,8,8,8,13,14,13,14,1,1,1,1,1,1,1,1,2,35,8,8,24,23,24,23,8,8,8,9,7,8,8,8,24,23,24,23,8,8,10,6,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,20,19,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,21,22,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,12,11,12,11,8,8,8,8,8,8,8,8,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,13,14,13,14,8,8,8,8,8,8,8,8,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,10,1,1,1,1,1,1,1,1,35,8,8,8,8,8,12,11,12,11,8,8,8,8,8,8,8,8,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,10,6,1,1,1,1,1,1,1,1,2,35,8,8,8,8,13,14,13,14,8,8,8,8,8,8,8,8,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,6,6,1,1,1,1,1,1,1,1,2,2,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,6,6,1,1,1,1,1,1,1,1,2,2,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,6,7,8,8,24,23,24,23,8,8,9,2,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,7,8,8,8,24,23,24,23,8,8,8,9,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,35,8,8,8,8,8,8,8,9,2],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,2,35,8,8,8,8,8,8,8,9],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,20,19,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,12,11,12,11,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,21,22,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,13,14,13,14,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,12,11,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,13,14,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,6,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,6,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,2,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
		[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
	]
}

const ladders = {
	f1: {
		up: [],
		down: [{x: 5, y: 5}, {x: 17, y: 11}, {x: 25, y: 15}],
	},
	b1: {
		up: [{x: 5, y: 5}, {x: 27, y: 3}, {x: 25, y: 9}, {x: 25, y: 15}],
		down: [{x: 23, y: 3}, {x: 17, y: 11}, {x: 21, y: 17}, {x: 13, y: 27}],
	},
	b2: {
		up: [{x: 5, y: 7}, {x: 25, y: 9}, {x: 21, y: 17}, {x: 15, y: 27}],
		down: [],
	},
}

function get_next_floor(floor, direction) {
	const floors = Object.keys(maps)
	const offset = direction === 'up' ? -1 : 1
	const next_floor_index = floors.findIndex(e => e === floor) + offset
	return floors[next_floor_index]
}

const screen_width = 20
const screen_height = 18

function gen_transition_mappings(map) {
	const forbidden_tiles = [33];

	const width = map[0].length;
	const height = map.length;

	const t_e = new Map()
	for (let r = 0; r < height - screen_height; r += 2) {
		for (let c = 1; c < width - 2; c += 2) {
			const from = new Array(screen_height)
			const to = [new Array(screen_height), new Array(screen_height)]
			for (let i = 0; i < screen_height; ++i) {
				from[i] = map[r + i][c];
				to[0][i] = map[r + i][c + 1];
				to[1][i] = map[r + i][c + 2];
			}
			if (to.some(arr => arr.some(i => forbidden_tiles.includes(i)))) continue
			const from_s = from.join()
			if (!t_e.has(from_s)) t_e.set(from_s, [])
			t_e.get(from_s).push(to)
		}
	}

	const t_n = new Map()
	for (let r = 2; r < height; r += 2) {
		for (let c = 0; c < width - screen_width; c += 2) {
			const from = new Array(screen_width)
			const to = [new Array(screen_width), new Array(screen_width)]
			for (let i = 0; i < screen_width; ++i) {
				from[i] = map[r][c + i];
				to[0][i] = map[r - 1][c + i];
				to[1][i] = map[r - 2][c + i];
			}
			if (to.some(arr => arr.some(i => forbidden_tiles.includes(i)))) continue
			const from_s = from.join()
			if (!t_n.has(from_s)) t_n.set(from_s, [])
			t_n.get(from_s).push(to)
		}
	}

	const t_w = new Map()
	for (let r = 0; r < height - screen_height; r += 2) {
		for (let c = 2; c < width; c += 2) {
			const from = new Array(screen_height)
			const to = [new Array(screen_height), new Array(screen_height)]
			for (let i = 0; i < screen_height; ++i) {
				from[i] = map[r + i][c];
				to[0][i] = map[r + i][c - 1];
				to[1][i] = map[r + i][c - 2];
			}
			if (to.some(arr => arr.some(i => forbidden_tiles.includes(i)))) continue
			const from_s = from.join()
			if (!t_w.has(from_s)) t_w.set(from_s, [])
			t_w.get(from_s).push(to)
		}
	}

	const t_s = new Map()
	for (let r = 1; r < height - 2; r += 2) {
		for (let c = 0; c < width - screen_width; c += 2) {
			const from = new Array(screen_width)
			const to = [new Array(screen_width), new Array(screen_width)]
			for (let i = 0; i < screen_width; ++i) {
				from[i] = map[r][c + i];
				to[0][i] = map[r + 1][c + i];
				to[1][i] = map[r + 2][c + i];
			}
			if (to.some(arr => arr.some(i => forbidden_tiles.includes(i)))) continue
			const from_s = from.join()
			if (!t_s.has(from_s)) t_s.set(from_s, [])
			t_s.get(from_s).push(to)
		}
	}

	return {e: t_e, n: t_n, w: t_w, s: t_s}
}

const default_subs = {
	'e': [
		[0, 0], [1, 2], [0, 0], [0, 0], [4, 3], [4, 3],
		[1, 2], [8, 9], [8, 9], [0, 0], [1, 2], [0, 0],
		[11, 0], [14, 0], [0, 0], [0, 0], [15, 0], [18, 0],
		[0, 0], [0, 0], [19, 0], [22, 0], [0, 0], [8, 9],
		[23, 9], [0, 0], [25, 0], [28, 0], [0, 0], [0, 0],
		[29, 0], [32, 0], [0, 0], [0, 0], [34, 34], [8, 9],
	],
	'n': [
		[0, 0], [1, 4], [2, 3], [0, 0], [0, 0], [0, 0],
		[6, 5], [6, 5], [1, 4], [2, 3], [1, 4], [0, 0],
		[0, 0], [12, 0], [11, 0], [0, 0], [0, 0], [16, 0],
		[15, 0], [0, 0], [0, 0], [20, 0], [19, 0], [0, 0],
		[0, 0], [0, 0], [0, 0], [26, 0], [25, 0], [0, 0],
		[0, 0], [30, 0], [29, 0], [0, 0], [34, 34], [1, 4],
	],
	'w': [
		[0, 0], [1, 6], [4, 5], [4, 5], [4, 5], [0, 0],
		[0, 0], [0, 0], [8, 7], [8, 7], [8, 7], [12, 0],
		[0, 0], [0, 0], [13, 0], [16, 0], [0, 0], [0, 0],
		[17, 0], [19, 0], [0, 0], [0, 0], [21, 0], [24, 7],
		[8, 7], [26, 0], [0, 0], [0, 0], [27, 0], [30, 0],
		[0, 0], [0, 0], [31, 0], [0, 0], [34, 34], [1, 6],
	],
	's': [
		[0, 0], [1, 8], [2, 9], [2, 9], [1, 8], [6, 7],
		[6, 7], [0, 0], [0, 0], [0, 0], [6, 7], [14, 0],
		[13, 0], [0, 0], [0, 0], [18, 0], [17, 0], [0, 0],
		[0, 0], [22, 0], [21, 0], [0, 0], [0, 0], [0, 0],
		[0, 0], [28, 0], [27, 0], [0, 0], [0, 0], [32, 0],
		[31, 0], [0, 0], [0, 0], [0, 0], [34, 34], [2, 9],
	],
}

function append_view(view, dir, transitions) {
	const from =
		dir === 'e' ? view.map(row => row[row.length - 1]) :
		dir === 'n' ? view[0] :
		dir === 's' ? view[view.length - 1] :
		dir === 'w' ? view.map(row => row[0]) :
		undefined
	const deflt = [
		new Array(from.length),
		new Array(from.length),
	]
	for (let i = 0; i < from.length; ++i) {
		const sub = default_subs[dir][from[i]]
		deflt[0][i] = sub[0]
		deflt[1][i] = sub[1]
	}
	const choices = transitions[dir].get(from.join()) ?? [deflt]
	const i = Math.floor(Math.random() * choices.length)
	const choice = window.structuredClone(choices[i])

	switch (dir) {
		case 'e':
			for (let i = 0; i < view.length; ++i) {
				view[i].push(choice[0][i])
				view[i].push(choice[1][i])
			}
			break
		case 'n':
			view.unshift(choice[0])
			view.unshift(choice[1])
			break
		case 'w':
			for (let i = 0; i < view.length; ++i) {
				view[i].unshift(choice[0][i])
				view[i].unshift(choice[1][i])
			}
			break
		case 's':
			view.push(choice[0])
			view.push(choice[1])
			break
	}
}

function truncate_view(view, dir) {
	switch (dir) {
		case 'e':
			for (let i = 0; i < view.length; ++i) {
				view[i].shift()
				view[i].shift()
			}
			break
		case 'n':
			view.pop()
			view.pop()
			break
		case 'w':
			for (let i = 0; i < view.length; ++i) {
				view[i].pop()
				view[i].pop()
			}
			break
		case 's':
			view.shift()
			view.shift()
			break
	}
}

const transitions = Object.fromEntries(Object.entries(maps).map(([name, map]) => [name, gen_transition_mappings(map)]))

function new_view(map, offset) {
	const view = []
	for (let r = 0; r < 18; ++r) {
		view.push([])
		for (let c = 0; c < 20; ++c) {
			view[r].push(map[r + offset.y * 2 - 8]?.at(c + offset.x * 2 - 8) ?? 34)
		}
	}
	return view
}

const tile_size = 8
const screen = document.getElementById('screen')
const ctx = screen.getContext('2d')
const tiles_image = await fetch('assets/tiles.png')
	.then(res => res.blob())
	.then(blob => window.createImageBitmap(blob))


const passable_tiles = [0, 1, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 33];
function is_passable(view, pos) {
	for (let r = pos[1]; r < pos[1] + 2; ++r)
		for (let c = pos[0]; c < pos[0] + 2; ++c)
			if (!passable_tiles.includes(view[r][c])) return false
	return true
}

function check_ladder_type(view, pos) {
	const tiles = [
		view[pos[1]][pos[0] + 1],
		view[pos[1]][pos[0]],
		view[pos[1] + 1][pos[0]],
		view[pos[1] + 1][pos[0] + 1],
	]

	if (tiles.join() === [15, 16, 17, 18].join()) return 'down'
	else if (tiles.join() === [19, 20, 21, 22].join()) return 'up'
	else return 'none'
}


function get_offset(i) {
	const width = tiles_image.width / tile_size
	const row = Math.floor(i / width)
	const col = i % width
	return [col * tile_size, row * tile_size]
}

function draw_tile(i, r, c) {
	const [tx, ty] = get_offset(i)
	const [x, y] = [c * tile_size, r * tile_size]
}

function draw_view(view, offset) {
	for (let r = 0; r < view.length; ++r) {
		for (let c = 0; c < view[r].length; ++c) {
			const [tx, ty] = get_offset(view[r][c])
			const [x, y] = [c * tile_size - offset.x, r * tile_size - offset.y]
			ctx.drawImage(tiles_image, tx, ty, tile_size, tile_size, x, y, tile_size, tile_size)
		}
	}
}

function draw_player() {
	ctx.fillStyle = 'rgba(0, 0, 0, 0.75)'
	ctx.beginPath()
	ctx.arc(16 * 4.5, 16 * 4.5, 7, 0, 2 * Math.PI)
	ctx.fill()
}

const init_offset = {x: 14, y: 35}
const state = {
	view: new_view(maps['f1'], init_offset),
	move_dir: null,
	moving: false,
	move_pos: 0,
	move_started: null,
	keys: new Set(),
	floor: 'f1',
}

document.body.addEventListener('keydown', e => state.keys.add(e.key))
document.body.addEventListener('keyup', e => state.keys.delete(e.key))

function run() {
	var just_finished_moving = false
	var offset = {x: 0, y: 0}

	if (state.moving) {} // don't process keys
	else if (state.keys.has('ArrowRight') && !state.keys.has('ArrowLeft')) state.move_dir = 'e'
	else if (state.keys.has('ArrowUp') && !state.keys.has('ArrowDown')) state.move_dir = 'n'
	else if (state.keys.has('ArrowLeft') && !state.keys.has('ArrowRight')) state.move_dir = 'w'
	else if (state.keys.has('ArrowDown') && !state.keys.has('ArrowUp')) state.move_dir = 's'

	if (!state.moving && state.move_dir !== null) {
		const next_pos =
			state.move_dir === 'e' ? [8 + 2, 8] :
			state.move_dir === 'n' ? [8, 8 - 2] :
			state.move_dir === 's' ? [8, 8 + 2] :
			state.move_dir === 'w' ? [8 - 2, 8] :
			undefined
		if (is_passable(state.view, next_pos)) {
			state.moving = true
			state.move_started = performance.now()
			append_view(state.view, state.move_dir, transitions[state.floor])
		}
	}

	if (state.moving) {
		const move_time = (performance.now() - state.move_started) / 1000 * 3
		const norm_move_time = Math.min(Math.max(move_time, 0.0), 1.0)
		just_finished_moving = norm_move_time === 1.0

		if (just_finished_moving) {
			truncate_view(state.view, state.move_dir)
			state.moving = false
			state.move_dir = null
			state.move_started = null
		} else {
			offset =
				state.move_dir === 'e' ? {x: norm_move_time * tile_size * 2, y: 0} :
				state.move_dir === 'n' ? {x: 0, y: (1.0 - norm_move_time) * tile_size * 2} :
				state.move_dir === 's' ? {x: 0, y: norm_move_time * tile_size * 2} :
				state.move_dir === 'w' ? {x: (1.0 - norm_move_time) * tile_size * 2, y: 0} :
				undefined
			offset = {x: Math.round(offset.x), y: Math.round(offset.y)}
		}
	}

	if (just_finished_moving) {
		const ladder_type = check_ladder_type(state.view, [8, 8])
		if (ladder_type != 'none') {
			const next_floor = get_next_floor(state.floor, ladder_type)
			const complementary_ladder_type = ladder_type === 'up' ? 'down' : 'up'
			const next_floor_ladders = ladders[next_floor][complementary_ladder_type]
			const i = Math.floor(Math.random() * next_floor_ladders.length)
			const random_ladder = next_floor_ladders[i]
			state.view = new_view(maps[next_floor], random_ladder)
			state.floor = next_floor
		}
	}

	draw_view(state.view, offset)
	draw_player()
	requestAnimationFrame(run)
}

requestAnimationFrame(run)

</script>
<canvas id=screen width=160 height=144></canvas>
